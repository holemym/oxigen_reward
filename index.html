<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#F4F0E9" />
<title>Oxigen — Your Wellness Reward</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />

<style>
:root {
--bg: #F4F0E9;
--surface: #FAF7F1;
--ink: #1A1A1A;
--text: #333333;
--muted: #666666;
--line: #E6E0D3;
--brand: #D1B370;
--brand-12: rgba(209,179,112,0.12);
--brand-08: rgba(209,179,112,0.08);
--brand-05: rgba(209,179,112,0.05);
--radius: 12px;
--pad: 1.5rem;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
font-family: 'Inter', sans-serif;
background:
radial-gradient(1200px 600px at 80% -10%, rgba(209,179,112,0.12), transparent),
radial-gradient(800px 500px at -10% 20%, rgba(209,179,112,0.08), transparent),
var(--bg);
color: var(--text);
line-height: 1.6;
min-height: 100vh;
display: flex;
align-items: center;
justify-content: center;
padding: 24px;
}

.container {
max-width: 520px;
width: 100%;
text-align: center;
padding: 64px 40px;
background: linear-gradient(180deg, var(--surface), #fff);
border: 1px solid var(--line);
border-radius: 16px;
box-shadow:
0 8px 30px rgba(26, 26, 26, 0.04),
0 18px 60px rgba(209, 179, 112, 0.12);
}

.divider {
height: 1px;
background: linear-gradient(90deg, transparent, var(--line), transparent);
margin: 24px 0;
}

/* Screens */
.screen { display: none; opacity: 0; transition: opacity .6s ease-out; }
.screen.active { display: block; opacity: 1; }

/* Type */
.heading {
font-family: 'Playfair Display', serif;
font-size: 2.2rem;
font-weight: 500;
color: var(--ink);
margin-bottom: 12px;
line-height: 1.2;
letter-spacing: .2px;
}
.subheading {
font-size: 1.05rem;
color: #3a3a3a;
margin-bottom: 28px;
line-height: 1.7;
}
.fine-print {
font-size: 0.875rem;
color: var(--muted);
margin-top: 16px;
line-height: 1.6;
}
.scratch-label {
font-size: 0.95rem;
color: var(--muted);
margin-top: 16px;
margin-bottom: 8px;
}
.h3 {
font-family: 'Playfair Display', serif;
font-size: 1.2rem;
color: var(--ink);
margin-bottom: 1rem;
text-align: left;
}
.h4 {
font-family: 'Playfair Display', serif;
font-size: 1.05rem;
color: var(--ink);
margin-bottom: .5rem;
}
.muted { color: var(--muted); }

/* Buttons */
.btn {
display: inline-block;
padding: 14px 28px;
border: 1.5px solid var(--brand);
background: transparent;
color: var(--brand);
text-decoration: none;
border-radius: 999px;
font-size: 0.98rem;
font-weight: 600;
letter-spacing: .2px;
cursor: pointer;
transition: transform .15s ease, color .15s ease, background .15s ease, box-shadow .15s ease;
margin: 6px;
min-width: 200px;
}
.btn:hover { background: var(--brand); color: #fff; transform: translateY(-1px); box-shadow: 0 6px 18px rgba(209,179,112,.25); }
.btn:active { transform: translateY(0); box-shadow: none; }
.btn-full { width: 100%; margin: 12px 0; }

.btn-secondary {
border-color: #B9B9B9;
color: #2A2A2A;
background: #fff;
}
.btn-secondary:hover { border-color: var(--brand); color: #fff; background: var(--brand); }

/* Scratch Card */
.scratch-container {
position: relative;
margin: 1.5rem auto 0;
width: 320px;
height: 170px;
border-radius: var(--radius);
overflow: hidden;
box-shadow: 0 10px 34px rgba(209, 179, 112, 0.18);
border: 1px solid var(--line);
background: #fff;
}
canvas.scratch-canvas {
position: absolute; inset: 0;
width: 100%; height: 100%;
cursor: grab; border-radius: var(--radius);
touch-action: none;
}
canvas.scratch-canvas:active { cursor: grabbing; }

.prize-content {
position: absolute; inset: 0;
display: flex; align-items: center; justify-content: center;
background: linear-gradient(135deg, #F7F3EB 0%, #FFFFFF 100%);
border-radius: var(--radius);
}
.prize-text {
font-family: 'Playfair Display', serif;
font-size: 1.35rem;
font-weight: 500;
color: var(--ink);
padding: 20px;
text-align: center;
line-height: 1.35;
}

.shimmer-hint {
position: absolute; inset: 0;
background: linear-gradient(45deg, transparent 30%, rgba(209, 179, 112, 0.12) 50%, transparent 70%);
animation: shimmer 2.8s ease-in-out infinite;
pointer-events: none;
border-radius: var(--radius);
}
.shimmer-hint.hidden { display: none; }
@keyframes shimmer {
0%, 100% { transform: translateX(-100%); opacity: 0; }
50% { transform: translateX(100%); opacity: 1; }
}

/* Reveal */
.prize-reveal { opacity: 0; transform: translateY(18px); transition: all .6s ease; }
.prize-reveal.show { opacity: 1; transform: translateY(0); }

.redemption-info {
margin: 20px 0 0;
padding: var(--pad);
background: #fff;
border-radius: var(--radius);
border: 1px solid var(--line);
text-align: left;
}
.redemption-box {
background: linear-gradient(180deg, #fff, #FBF8F2);
padding: var(--pad);
border-radius: 10px;
margin-bottom: 1.25rem;
border: 1px solid var(--brand-08);
}
.redemption-list { font-size: .9rem; color: var(--muted); line-height: 1.55; }

/* Email */
form.email-section {
margin: 1.25rem 0 0; padding: var(--pad);
background: #fff;
border-radius: var(--radius);
border: 1px solid var(--line);
text-align: left;
}
label.email-label {
font-size: 0.95rem; color: #4a4a4a; margin-bottom: 0.5rem; display: block;
}
.email-input {
width: 100%; padding: 14px 18px;
border: 1.5px solid #D8D2C6;
background: #FAF8F4;
border-radius: 25px;
font-size: 1rem;
color: var(--text);
transition: border-color .15s ease, box-shadow .15s ease, background .15s ease;
margin-bottom: 0.75rem;
}
.email-input::placeholder { color: #9A9489; }
.email-input:focus {
outline: none;
border-color: var(--brand);
background: #fff;
box-shadow: 0 0 0 3px var(--brand-12);
}

/* Particles */
.scratch-particle {
position: absolute;
width: 4px; height: 4px;
background: var(--brand);
border-radius: 50%;
pointer-events: none;
animation: particle-fall 0.8s ease-out forwards;
}
@keyframes particle-fall {
0% { opacity: 1; transform: translateY(0) rotate(0deg) scale(1); }
50% { opacity: .85; transform: translateY(10px) rotate(180deg) scale(.85); }
100% { opacity: 0; transform: translateY(24px) rotate(360deg) scale(.3); }
}

.fade-in { opacity: 0; transform: translateY(24px); }
.fade-in.ready { animation: fadeInUp .6s ease-out forwards; }
@keyframes fadeInUp { from { opacity:0; transform: translateY(24px);} to {opacity:1; transform: translateY(0);} }

@media (prefers-reduced-motion: reduce) {
* { animation: none !important; transition: none !important; }
}

@media (max-width: 520px) {
.container { padding: 44px 20px; border-radius: 14px; }
.heading { font-size: 1.9rem; }
.scratch-container { width: 300px; height: 160px; }
}
</style>
</head>
<body>
<div class="container">
<!-- Screen 1: Landing -->
<section class="screen active" id="landing" aria-labelledby="landingTitle">
<h1 id="landingTitle" class="heading fade-in">Unlock your Oxigen reward</h1>
<p class="subheading fade-in">Scratch the card to reveal an exclusive therapy benefit.</p>
<button class="btn btn-full fade-in" type="button" id="startBtn">Reveal my reward</button>
<div class="divider"></div>
<a class="btn btn-secondary btn-full fade-in" href="https://oxigen.at" target="_blank" rel="noopener">Explore Oxigen therapies</a>
<p class="fine-print fade-in">Valid for travelers in Vienna. Limited-time offer.</p>
</section>

<!-- Screen 2: Scratch Card -->
<section class="screen" id="scratch" aria-label="Scratch card to reveal your reward">
<div class="scratch-container" role="img" aria-label="Scratch area to reveal your reward">
<div class="prize-content">
<div class="prize-text" id="hiddenPrize"></div>
</div>
<canvas class="scratch-canvas" id="scratchCanvas" aria-hidden="true"></canvas>
<div class="shimmer-hint" id="shimmer"></div>
</div>
<p class="scratch-label" id="scratchLabel">Swipe across the card to uncover your reward</p>
</section>

<!-- Screen 3: Prize Reveal -->
<section class="screen" id="reveal" aria-labelledby="revealTitle">
<div class="prize-reveal" id="prizeReveal">
<h2 id="revealTitle" class="visually-hidden" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">Your reward</h2>
<div id="revealedPrize" class="prize-text" role="status" aria-live="polite"></div>
</div>

<form class="email-section" id="emailForm">
<h3 class="h3">Save your reward</h3>
<label class="email-label" for="emailInput">Email address</label>
<input type="email" class="email-input" placeholder="your.email@example.com" id="emailInput" required inputmode="email" autocomplete="email" />
<button class="btn btn-full" type="submit" id="emailSubmitBtn">Send to my email</button>
<div id="emailSuccess" aria-live="polite" style="display:none;margin-top:12px; padding:.75rem 1rem; background:#F0F8F2; color:#226B3A; border-radius:8px; font-size:.9rem; border:1px solid #C9E7D3;"></div>
</form>

<div class="redemption-info">
<div class="redemption-box">
<h4 class="h4">How to claim</h4>
<p class="muted" style="margin-bottom:12px;">
Take a screenshot of this reward and show it at Oxigen Vienna.
</p>
<p class="redemption-list">
• Valid for 30 days from today<br />
• One-time use only<br />
• Present screenshot at reception
</p>
</div>
<button class="btn btn-full" type="button" id="mapBtn">Get directions</button>
<button class="btn btn-full" type="button" id="bookBtn">Book appointment</button>
</div>
</section>
</div>

<script>
/* Prize pool (demo) */
const prizes = [
"Free Hyperbaric Oxygen Therapy Session",
"50% Off IV Drip Therapy",
"Free Massage Add-On",
"Better luck next time! Try again to unlock your wellness reward."
];

function openSafe(url) { window.open(url, '_blank', 'noopener,noreferrer'); }

let canvas, ctx;
let isDrawing = false, prizeRevealed = false;
let lastX = 0, lastY = 0, lastTime = 0, currentSpeed = 0;
let lastProgressCheck = 0;
let offscreenProgressCanvas, offscreenCtx;

const landing = document.getElementById('landing');
const scratchScreen = document.getElementById('scratch');
const reveal = document.getElementById('reveal');

document.getElementById('startBtn').addEventListener('click', showScratchScreen);
document.getElementById('emailForm').addEventListener('submit', (e) => { e.preventDefault(); saveReward(); });
document.getElementById('mapBtn').addEventListener('click', () => openSafe('https://maps.google.com/?q=Oxigen+Center+Vienna'));
document.getElementById('bookBtn').addEventListener('click', () => openSafe('https://oxigen.at/en/booking'));

window.addEventListener('load', () => {
document.querySelectorAll('.fade-in').forEach((el, i) => setTimeout(() => el.classList.add('ready'), i * 90));
});

function showScratchScreen() {
landing.classList.remove('active');
setTimeout(() => { scratchScreen.classList.add('active'); initScratchCard(); }, 220);
}

function resetCanvas() {
const old = document.getElementById('scratchCanvas');
const fresh = old.cloneNode(true);
old.parentNode.replaceChild(fresh, old);
return fresh;
}

function selectPrize() {
const p = prizes[Math.floor(Math.random() * prizes.length)];
document.getElementById('hiddenPrize').textContent = p;
return p;
}

function initScratchCard() {
canvas = resetCanvas();
ctx = canvas.getContext('2d');

const container = canvas.parentElement;
const rect = container.getBoundingClientRect();

const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
canvas.width = rect.width * dpr;
canvas.height = rect.height * dpr;
canvas.style.width = rect.width + 'px';
canvas.style.height = rect.height + 'px';
ctx.setTransform(dpr, 0, 0, dpr, 0, 0);

offscreenProgressCanvas = document.createElement('canvas');
offscreenProgressCanvas.width = 96;
offscreenProgressCanvas.height = Math.max(48, Math.round(96 * (rect.height / rect.width)));
offscreenCtx = offscreenProgressCanvas.getContext('2d');

const gradient = ctx.createLinearGradient(0, 0, rect.width, rect.height);
gradient.addColorStop(0, '#F2E6B8');
gradient.addColorStop(0.15, '#E6D196');
gradient.addColorStop(0.3, '#D1B370');
gradient.addColorStop(0.5, '#C9A961');
gradient.addColorStop(0.7, '#B8A055');
gradient.addColorStop(0.85, '#A6924A');
gradient.addColorStop(1, '#94823F');

ctx.fillStyle = gradient;
ctx.fillRect(0, 0, rect.width, rect.height);

ctx.globalCompositeOperation = 'overlay';
for (let i = 0; i < 1000; i++) {
ctx.fillStyle = `rgba(255,255,255,${Math.random() * 0.15})`;
ctx.fillRect(Math.random() * rect.width, Math.random() * rect.height, 1, 1);
}
ctx.globalCompositeOperation = 'multiply';
ctx.fillStyle = 'rgba(200,180,120,0.1)';
for (let x = 0; x < rect.width; x += 3) {
for (let y = 0; y < rect.height; y += 3) if (Math.random() > 0.7) ctx.fillRect(x, y, 1, 1);
}
ctx.globalCompositeOperation = 'source-over';

selectPrize();

const shimmer = document.getElementById('shimmer');
shimmer.classList.remove('hidden');
document.getElementById('scratchLabel').style.opacity = '1';

canvas.addEventListener('mousedown', startScratch);
canvas.addEventListener('mousemove', scratch);
window.addEventListener('mouseup', stopScratch);
canvas.addEventListener('touchstart', startScratch, { passive: false });
canvas.addEventListener('touchmove', scratch, { passive: false });
window.addEventListener('touchend', stopScratch);
}

function getCoordinates(e) {
const rect = canvas.getBoundingClientRect();
const p = (e.touches && e.touches[0]) || e;
return { x: (p.clientX - rect.left), y: (p.clientY - rect.top) };
}

function startScratch(e) {
isDrawing = true;
document.getElementById('shimmer').classList.add('hidden');
document.getElementById('scratchLabel').style.opacity = '.6';
const { x, y } = getCoordinates(e);
lastX = x; lastY = y; lastTime = performance.now(); currentSpeed = 0;
scratch(e);
}

function scratch(e) {
if (!isDrawing || prizeRevealed) return;
e.preventDefault();

const { x: cx, y: cy } = getCoordinates(e);
const now = performance.now();

const dx = cx - lastX, dy = cy - lastY;
const distance = Math.hypot(dx, dy);
const dt = Math.max(now - lastTime, 1);
currentSpeed = distance / dt * 100;

ctx.globalCompositeOperation = 'destination-out';
createBrushyScratches(cx, cy, lastX, lastY, currentSpeed);

if (Math.random() > 0.5) createScratchParticle(cx, cy);

lastX = cx; lastY = cy; lastTime = now;
maybeCheckProgress();
}

function stopScratch() { isDrawing = false; }

function maybeCheckProgress() {
const now = performance.now();
if (now - lastProgressCheck < 120) return;
lastProgressCheck = now;
checkScratchProgress();
}

function checkScratchProgress() {
if (prizeRevealed) return;

offscreenCtx.clearRect(0, 0, offscreenProgressCanvas.width, offscreenProgressCanvas.height);
offscreenCtx.drawImage(canvas, 0, 0, canvas.width, canvas.height, 0, 0, offscreenProgressCanvas.width, offscreenProgressCanvas.height);
const data = offscreenCtx.getImageData(0, 0, offscreenProgressCanvas.width, offscreenProgressCanvas.height).data;

let transparent = 0;
for (let i = 3; i < data.length; i += 4) if (data[i] === 0) transparent++;
const pct = (transparent / (data.length / 4)) * 100;

if (pct > 20) document.getElementById('scratchLabel').style.opacity = '0';
if (pct > 60) revealPrize();
}

function createBrushyScratches(x, y, lx, ly, speed) {
const baseSize = 35, maxSize = 140;
const s = Math.min(speed / 4, 1.2);
const brush = baseSize + (maxSize - baseSize) * s;

ctx.globalAlpha = (0.6 + Math.random() * 0.4) * Math.min(speed / 8 + 0.3, 1.0);
ctx.lineWidth = brush * 0.6;
ctx.lineCap = 'round'; ctx.lineJoin = 'round';

const segs = 4 + Math.floor(Math.random() * 6);
ctx.beginPath(); ctx.moveTo(lx, ly);
for (let i = 1; i <= segs; i++) {
const t = i / segs;
const nv = Math.sin(t * Math.PI * 3) * 3;
const j = (Math.random() - 0.5) * 8;
const X = lx + (x - lx) * t + nv + j;
const Y = ly + (y - ly) * t + (Math.random() - 0.5) * 8;
if (i === 1) ctx.quadraticCurveTo(lx, ly, X, Y); else ctx.lineTo(X, Y);
}
ctx.stroke();

const n = Math.floor(12 + speed / 2);
for (let i = 0; i < n; i++) {
const r = Math.random() * brush * 1.5;
const a = Math.random() * Math.PI * 2;
createDetailedScratchMark(x + Math.cos(a) * r, y + Math.sin(a) * r, Math.min(speed / 8 + 0.3, 1.0));
}
ctx.globalAlpha = 1;
}

function createDetailedScratchMark(x, y, p) {
const w = (Math.random() * 4 + 1) * p;
const a = (Math.random() * 0.7 + 0.2) * p;
const ang = Math.random() * Math.PI * 2;
const len = (3 + Math.random() * 8) * p;

ctx.globalAlpha = a;
ctx.lineWidth = w;
ctx.lineCap = Math.random() > 0.5 ? 'round' : 'square';

ctx.beginPath();
ctx.moveTo(x, y);
const ex = x + Math.cos(ang) * len, ey = y + Math.sin(ang) * len;
ctx.lineTo(ex, ey);

if (Math.random() > 0.6) {
const ba = ang + (Math.random() - 0.5);
const bl = len * 0.3;
const mx = x + Math.cos(ang) * len * 0.6;
const my = y + Math.sin(ang) * len * 0.6;
ctx.moveTo(mx, my);
ctx.lineTo(mx + Math.cos(ba) * bl, my + Math.sin(ba) * bl);
}
ctx.stroke();
ctx.globalAlpha = 1;
}

function createScratchParticle(x, y) {
const container = document.querySelector('.scratch-container');
const MAX = 150;
if (container.querySelectorAll('.scratch-particle').length > MAX) return;

const count = 2 + Math.floor(Math.random() * 4);
for (let i = 0; i < count; i++) {
const p = document.createElement('div');
p.className = 'scratch-particle';
const size = 2 + Math.random() * 6;
const opacity = 0.4 + Math.random() * 0.6;
const hue = 40 + Math.random() * 20;
p.style.width = size + 'px';
p.style.height = size + 'px';
p.style.background = `hsla(${hue}, 70%, 60%, ${opacity})`;
p.style.left = (x + (Math.random() - 0.5) * 20) + 'px';
p.style.top = (y + (Math.random() - 0.5) * 20) + 'px';
container.appendChild(p);
setTimeout(() => p.remove(), 600 + Math.random() * 400);
}
}

function revealPrize() {
if (prizeRevealed) return;
prizeRevealed = true;
scratchScreen.style.opacity = '0';
setTimeout(() => {
scratchScreen.classList.remove('active');
const t = document.getElementById('hiddenPrize').textContent;
if (t.includes("Better luck next time")) {
showTryAgainScreen();
} else {
reveal.classList.add('active');
document.getElementById('revealedPrize').textContent = t;
setTimeout(() => document.getElementById('prizeReveal').classList.add('show'), 80);
}
}, 360);
}

function showTryAgainScreen() {
let tryAgainScreen = document.getElementById('tryAgain');
if (!tryAgainScreen) {
tryAgainScreen = document.createElement('section');
tryAgainScreen.id = 'tryAgain';
tryAgainScreen.className = 'screen';
tryAgainScreen.innerHTML = `
<div class="prize-reveal" id="tryAgainContent" style="text-align:center;">
<h2 class="heading" style="font-size:1.7rem;margin-bottom:.6rem;">No win this time</h2>
<p class="subheading" style="margin-bottom:1.2rem;">Try again — your reward is close.</p>
<button class="btn btn-full" type="button" id="tryAgainBtn">Try again</button>
</div>`;
document.querySelector('.container').appendChild(tryAgainScreen);
tryAgainScreen.querySelector('#tryAgainBtn').addEventListener('click', tryAgain);
}
tryAgainScreen.classList.add('active');
setTimeout(() => document.getElementById('tryAgainContent').classList.add('show'), 60);
}

function tryAgain() {
prizeRevealed = false;
const ta = document.getElementById('tryAgain');
ta.classList.remove('active');
document.getElementById('tryAgainContent').classList.remove('show');
setTimeout(() => { scratchScreen.classList.add('active'); scratchScreen.style.opacity = '1'; initScratchCard(); }, 220);
}

/* ---- Google Apps Script submit (form-encoded to avoid CORS headaches) ---- */
async function saveReward() {
const email = document.getElementById('emailInput').value.trim();
const prize = document.getElementById('revealedPrize').textContent.trim();
if (!/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email)) { alert('Enter a valid email'); return; }

const btn = document.getElementById('emailSubmitBtn');
const successEl = document.getElementById('emailSuccess');
const original = btn.textContent;
btn.textContent = 'Sending…'; btn.disabled = true;

const endpoint = 'https://script.google.com/macros/s/APP_SCRIPT_ID/exec'; // ← replace with your Web App URL
const payload = new URLSearchParams({ email, prize });

try {
await fetch(endpoint, {
method: 'POST',
headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
body: payload.toString(),
mode: 'no-cors' // we don't need to read the response; this avoids CORS issues
});

btn.textContent = 'Sent';
btn.style.background = 'var(--brand)';
btn.style.color = '#fff';
btn.style.borderColor = 'var(--brand)';
successEl.style.display = 'block';
successEl.textContent = `Reward details sent to ${email}`;
} catch (e) {
alert('Error, please try again.');
btn.textContent = original;
} finally {
setTimeout(()=>{ btn.disabled = false; }, 1200);
}
}

/* Production notes:
- Swap selectPrize() with a server decision returning {prizeId, token}.
- POST { email, token } to lock the prize, render a code/QR.
- Enforce retry rules server-side.
*/
</script>
</body>
</html>
